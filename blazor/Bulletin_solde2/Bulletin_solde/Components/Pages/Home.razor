@page "/"
@using Bulletin_solde.Data.Models
@using Bulletin_solde.Data.Services
@inject Data.ApplicationDbContext DbContext
@inject BulletinServices bServices
@rendermode InteractiveServer

<h3>Liste des bulletins</h3>

<UploadJson></UploadJson>
<Dropdown TEnum="VisualisationModes" SelectedValue="selectedMode" SelectedValueChanged="OnDropDownChanged"></Dropdown>
<p>Selected mode is @selectedMode</p>

@if(selectedMode == VisualisationModes.Bulletin)
{
    <BulletinsLineChart bulletins="@bulletins"></BulletinsLineChart>
}else if (selectedMode == VisualisationModes.Month)
{
    
}

@code {
    private VisualisationModes selectedMode = VisualisationModes.Bulletin;
    List<Bulletin>? bulletins;

    protected override async Task OnInitializedAsync()
    {
        bulletins = await bServices.GetAllBulletins();
    }

    private void OnDropDownChanged(VisualisationModes newMode)
    {
        selectedMode = newMode;
        StateHasChanged();
        Console.WriteLine($"Dropdown changed to {newMode}");
    }
}
